# API
支持RESTful规范，对请求与响应有一定的要求

--------------------------------------------------------------------------------

## 请求
### GET
- 请求参数根据业务需求自定义
- 在datatables用有预设参数，比如:page,pagesize,详细见api-datatable.md

### POST/PUT/PATCH
- 这三种请求 contentType:"application/json"
- 业务数据统一放在 data 对象中，例如要提交 username 与 email 这两个字段，格式如下:

```json
{
  "data":{
      "username":"foobar",
      "email":"foo@bar.com"
  }
}
```

### DELETE
- 传参方式和GET请求一样

--------------------------------------------------------------------------------

## 响应
后端系统对所有Ajax请求都将返回统一的JSON格式数据，如下：

```js
    {
        "code":"200000",
        "message":"......",
        "result":{
            "summary":{},   
            "items":[{...},{...},{...}]
        },
        "page":{"current":1,"pagesize":10,"total":16},
        "fields":{
                "field1":[{"code":"","message":""}]
                "field2":[{"code":"","message":""}]
        }
    }
```

- code: 状态码,见以下 Code list 详细说明;
- message: 消息;
- result: 数据结果,可以根据业务自定义数据格式,如果是给datatables返回数据,则需要返回items数组,如果有汇总信息，同时还需要返回summary对象;
  - summary 汇总信息
  - items 数据项

- page: 分页信息,current:当前页码,pagesize:每页显示条目数,total:总条目数;
- fields: 字段验证信息

### Code list
- 200000     操作成功
- 200001     服务端验证-全局提示
- 200002     服务端验证-字段验证
- 200400     参数错误
- 200404     该页面不存在
- 200403     没有权限
- 200403.11  没有权限：密码更改而导致无权查看
- 200403.13  没有权限：管理员注销了当前用户
- 200403.17  没有权限：session失效
- 200403.18  没有权限：当前用户在别的终端登录，被注销
- 100500     出现异常

_code说明_
- 第1 位代表系统或服务级：1是系统级,2是服务级
- 第2,3位代表模块编
- 第4,5,6位为错误标识
- .(点)后面的是错误细分
