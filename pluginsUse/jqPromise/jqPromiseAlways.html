<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
</head>
<body>

<h4>deferred.always()这个方法也是用来指定回调函数的，它的作用是，不管调用的是deferred.resolve()还是deferred.reject()，最后总是执行</h4>
<h4>promise的讲解</h4>
<script>


    var task1 = function () {
        var dtd1 = $.Deferred();
        var task = function () {
            alert("task111111111111执行完毕");
            /*dtd.reject("promise执行出错了");*/
            /*dtd1.resolve("promise1111111111执行成功")*/
            dtd1.reject("使用的always，不管是失败还是成功都在always函数里面执行")
        }
        setTimeout(task,2000);
        //TODO 不返回dtd则会马上执行.done，原因在于$.when()的返回参数只能是deferred对象，所以必须对wait()进行改写
        return dtd1;
    }

    $.when(
        task1()
    )
        .always(function (msg) {
            console.log(msg);
            alert(msg);
        })
</script>
</body>
</html>