<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
</head>
<body>

<h4><a href="">http://www.ruanyifeng.com/blog/2011/08/a_detailed_explanation_of_jquery_deferred_object.html</a></h4>
<h4>promise的讲解</h4>
<script>
    /*var dtd = $.Deferred();*/

    var task1 = function () {
        var dtd1 = $.Deferred();
        var task = function () {
            alert("task111111111111执行完毕");
            /*dtd.reject("promise执行出错了");*/
            dtd1.resolve("promise1111111111执行成功")
        }
        setTimeout(task,2000);
        //TODO 不返回dtd则会马上执行.done，原因在于$.when()的返回参数只能是deferred对象，所以必须对wait()进行改写
        return dtd1;
    }

    $.when(
        task1()
    )
        .done(function (msg) {
            console.log(msg);
            alert(msg);
        })
        .fail(function (msg) {
            alert(msg);
        })
</script>
</body>
</html>